<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>















    




    
    
    
    


<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Anisha Patel<a rel="noopener" class="anchor-link" href="#Anisha-Patel">&#182;</a></h1><p>DSC 478</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[107]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span><span class="p">,</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">cross_validate</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">ElasticNet</span><span class="p">,</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[108]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;/Users/vinodpatel/Desktop/DePaul/DSC 478 Programming machine learning/Hw3/communities/communities.csv&quot;</span><span class="p">,</span> <span class="n">na_values</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;?&quot;</span><span class="p">,</span> <span class="s2">&quot;Null&quot;</span><span class="p">,</span> <span class="s2">&quot;missing&quot;</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[109]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[109]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8</td>
      <td>Lakewoodcity</td>
      <td>0.19</td>
      <td>0.33</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>0.12</td>
      <td>0.17</td>
      <td>0.34</td>
      <td>0.47</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.12</td>
      <td>0.42</td>
      <td>0.50</td>
      <td>0.51</td>
      <td>0.64</td>
      <td>0.12</td>
      <td>0.26</td>
      <td>0.20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>53</td>
      <td>Tukwilacity</td>
      <td>0.00</td>
      <td>0.16</td>
      <td>0.12</td>
      <td>0.74</td>
      <td>0.45</td>
      <td>0.07</td>
      <td>0.26</td>
      <td>0.59</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.21</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.60</td>
      <td>0.52</td>
      <td>0.02</td>
      <td>0.12</td>
      <td>0.45</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>24</td>
      <td>Aberdeentown</td>
      <td>0.00</td>
      <td>0.42</td>
      <td>0.49</td>
      <td>0.56</td>
      <td>0.17</td>
      <td>0.04</td>
      <td>0.39</td>
      <td>0.47</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.14</td>
      <td>0.49</td>
      <td>0.54</td>
      <td>0.67</td>
      <td>0.56</td>
      <td>0.01</td>
      <td>0.21</td>
      <td>0.02</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>3</th>
      <td>34</td>
      <td>Willingborotownship</td>
      <td>0.04</td>
      <td>0.77</td>
      <td>1.00</td>
      <td>0.08</td>
      <td>0.12</td>
      <td>0.10</td>
      <td>0.51</td>
      <td>0.50</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.19</td>
      <td>0.30</td>
      <td>0.73</td>
      <td>0.64</td>
      <td>0.65</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>0.28</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>42</td>
      <td>Bethlehemtownship</td>
      <td>0.01</td>
      <td>0.55</td>
      <td>0.02</td>
      <td>0.95</td>
      <td>0.09</td>
      <td>0.05</td>
      <td>0.38</td>
      <td>0.38</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.11</td>
      <td>0.72</td>
      <td>0.64</td>
      <td>0.61</td>
      <td>0.53</td>
      <td>0.04</td>
      <td>0.09</td>
      <td>0.02</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[110]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1">##OtherPerCap has 1993 instances, replace the &quot;?&quot; with its mean</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1994 entries, 0 to 1993
Data columns (total 100 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   state                  1994 non-null   int64  
 1   communityname          1994 non-null   object 
 2   population             1994 non-null   float64
 3   householdsize          1994 non-null   float64
 4   racepctblack           1994 non-null   float64
 5   racePctWhite           1994 non-null   float64
 6   racePctAsian           1994 non-null   float64
 7   racePctHisp            1994 non-null   float64
 8   agePct12t21            1994 non-null   float64
 9   agePct12t29            1994 non-null   float64
 10  agePct16t24            1994 non-null   float64
 11  agePct65up             1994 non-null   float64
 12  numbUrban              1994 non-null   float64
 13  pctUrban               1994 non-null   float64
 14  medIncome              1994 non-null   float64
 15  pctWWage               1994 non-null   float64
 16  pctWFarmSelf           1994 non-null   float64
 17  pctWInvInc             1994 non-null   float64
 18  pctWSocSec             1994 non-null   float64
 19  pctWPubAsst            1994 non-null   float64
 20  pctWRetire             1994 non-null   float64
 21  medFamInc              1994 non-null   float64
 22  perCapInc              1994 non-null   float64
 23  whitePerCap            1994 non-null   float64
 24  blackPerCap            1994 non-null   float64
 25  indianPerCap           1994 non-null   float64
 26  AsianPerCap            1994 non-null   float64
 27  OtherPerCap            1993 non-null   float64
 28  HispPerCap             1994 non-null   float64
 29  NumUnderPov            1994 non-null   float64
 30  PctPopUnderPov         1994 non-null   float64
 31  PctLess9thGrade        1994 non-null   float64
 32  PctNotHSGrad           1994 non-null   float64
 33  PctBSorMore            1994 non-null   float64
 34  PctUnemployed          1994 non-null   float64
 35  PctEmploy              1994 non-null   float64
 36  PctEmplManu            1994 non-null   float64
 37  PctEmplProfServ        1994 non-null   float64
 38  MalePctDivorce         1994 non-null   float64
 39  MalePctNevMarr         1994 non-null   float64
 40  FemalePctDiv           1994 non-null   float64
 41  TotalPctDiv            1994 non-null   float64
 42  PersPerFam             1994 non-null   float64
 43  PctFam2Par             1994 non-null   float64
 44  PctKids2Par            1994 non-null   float64
 45  PctYoungKids2Par       1994 non-null   float64
 46  PctTeen2Par            1994 non-null   float64
 47  PctWorkMomYoungKids    1994 non-null   float64
 48  PctWorkMom             1994 non-null   float64
 49  NumIlleg               1994 non-null   float64
 50  PctIlleg               1994 non-null   float64
 51  NumImmig               1994 non-null   float64
 52  PctImmigRecent         1994 non-null   float64
 53  PctImmigRec5           1994 non-null   float64
 54  PctImmigRec8           1994 non-null   float64
 55  PctImmigRec10          1994 non-null   float64
 56  PctRecentImmig         1994 non-null   float64
 57  PctRecImmig5           1994 non-null   float64
 58  PctRecImmig8           1994 non-null   float64
 59  PctRecImmig10          1994 non-null   float64
 60  PctSpeakEnglOnly       1994 non-null   float64
 61  PctNotSpeakEnglWell    1994 non-null   float64
 62  PctLargHouseFam        1994 non-null   float64
 63  PctLargHouseOccup      1994 non-null   float64
 64  PersPerOccupHous       1994 non-null   float64
 65  PersPerOwnOccHous      1994 non-null   float64
 66  PersPerRentOccHous     1994 non-null   float64
 67  PctPersOwnOccup        1994 non-null   float64
 68  PctPersDenseHous       1994 non-null   float64
 69  PctHousLess3BR         1994 non-null   float64
 70  MedNumBR               1994 non-null   float64
 71  HousVacant             1994 non-null   float64
 72  PctHousOccup           1994 non-null   float64
 73  PctHousOwnOcc          1994 non-null   float64
 74  PctVacantBoarded       1994 non-null   float64
 75  PctVacMore6Mos         1994 non-null   float64
 76  MedYrHousBuilt         1994 non-null   float64
 77  PctHousNoPhone         1994 non-null   float64
 78  PctWOFullPlumb         1994 non-null   float64
 79  OwnOccLowQuart         1994 non-null   float64
 80  OwnOccMedVal           1994 non-null   float64
 81  OwnOccHiQuart          1994 non-null   float64
 82  RentLowQ               1994 non-null   float64
 83  RentMedian             1994 non-null   float64
 84  RentHighQ              1994 non-null   float64
 85  MedRent                1994 non-null   float64
 86  MedRentPctHousInc      1994 non-null   float64
 87  MedOwnCostPctInc       1994 non-null   float64
 88  MedOwnCostPctIncNoMtg  1994 non-null   float64
 89  NumInShelters          1994 non-null   float64
 90  NumStreet              1994 non-null   float64
 91  PctForeignBorn         1994 non-null   float64
 92  PctBornSameState       1994 non-null   float64
 93  PctSameHouse85         1994 non-null   float64
 94  PctSameCity85          1994 non-null   float64
 95  PctSameState85         1994 non-null   float64
 96  LandArea               1994 non-null   float64
 97  PopDens                1994 non-null   float64
 98  PctUsePubTrans         1994 non-null   float64
 99  ViolentCrimesPerPop    1994 non-null   float64
dtypes: float64(98), int64(1), object(1)
memory usage: 1.5+ MB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[112]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span> <span class="o">=</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[112]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1994.000000</td>
      <td>1994</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>...</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
      <td>1994.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>1828</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>Greenvillecity</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>28.683551</td>
      <td>NaN</td>
      <td>0.057593</td>
      <td>0.463395</td>
      <td>0.179629</td>
      <td>0.753716</td>
      <td>0.153681</td>
      <td>0.144022</td>
      <td>0.424218</td>
      <td>0.493867</td>
      <td>...</td>
      <td>0.022778</td>
      <td>0.215552</td>
      <td>0.608892</td>
      <td>0.535050</td>
      <td>0.626424</td>
      <td>0.651530</td>
      <td>0.065231</td>
      <td>0.232854</td>
      <td>0.161685</td>
      <td>0.237979</td>
    </tr>
    <tr>
      <th>std</th>
      <td>16.397553</td>
      <td>NaN</td>
      <td>0.126906</td>
      <td>0.163717</td>
      <td>0.253442</td>
      <td>0.244039</td>
      <td>0.208877</td>
      <td>0.232492</td>
      <td>0.155196</td>
      <td>0.143564</td>
      <td>...</td>
      <td>0.100400</td>
      <td>0.231134</td>
      <td>0.204329</td>
      <td>0.181352</td>
      <td>0.200521</td>
      <td>0.198221</td>
      <td>0.109459</td>
      <td>0.203092</td>
      <td>0.229055</td>
      <td>0.232985</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>12.000000</td>
      <td>NaN</td>
      <td>0.010000</td>
      <td>0.350000</td>
      <td>0.020000</td>
      <td>0.630000</td>
      <td>0.040000</td>
      <td>0.010000</td>
      <td>0.340000</td>
      <td>0.410000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.060000</td>
      <td>0.470000</td>
      <td>0.420000</td>
      <td>0.520000</td>
      <td>0.560000</td>
      <td>0.020000</td>
      <td>0.100000</td>
      <td>0.020000</td>
      <td>0.070000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>34.000000</td>
      <td>NaN</td>
      <td>0.020000</td>
      <td>0.440000</td>
      <td>0.060000</td>
      <td>0.850000</td>
      <td>0.070000</td>
      <td>0.040000</td>
      <td>0.400000</td>
      <td>0.480000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.130000</td>
      <td>0.630000</td>
      <td>0.540000</td>
      <td>0.670000</td>
      <td>0.700000</td>
      <td>0.040000</td>
      <td>0.170000</td>
      <td>0.070000</td>
      <td>0.150000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>42.000000</td>
      <td>NaN</td>
      <td>0.050000</td>
      <td>0.540000</td>
      <td>0.230000</td>
      <td>0.940000</td>
      <td>0.170000</td>
      <td>0.160000</td>
      <td>0.470000</td>
      <td>0.540000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.280000</td>
      <td>0.777500</td>
      <td>0.660000</td>
      <td>0.770000</td>
      <td>0.790000</td>
      <td>0.070000</td>
      <td>0.280000</td>
      <td>0.190000</td>
      <td>0.330000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>56.000000</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>11 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[113]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[113]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[114]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="p">[</span><span class="n">community</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[114]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>communityname</th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>130</th>
      <td>28</td>
      <td>Natchezcity</td>
      <td>0.02</td>
      <td>0.38</td>
      <td>0.98</td>
      <td>0.22</td>
      <td>0.01</td>
      <td>0.01</td>
      <td>0.44</td>
      <td>0.4</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>0.84</td>
      <td>0.7</td>
      <td>0.83</td>
      <td>0.77</td>
      <td>0.04</td>
      <td>0.12</td>
      <td>0.05</td>
      <td>0.23</td>
    </tr>
  </tbody>
</table>
<p>1 rows &#215; 100 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[115]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Replacing the OtherPerCap missing value with its mean</span>
<span class="n">OtherPerCap_mean</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">OtherPerCap</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">community</span><span class="o">.</span><span class="n">OtherPerCap</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">OtherPerCap_mean</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[116]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="c1">#No null values</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1994 entries, 0 to 1993
Data columns (total 100 columns):
 #   Column                 Non-Null Count  Dtype  
---  ------                 --------------  -----  
 0   state                  1994 non-null   int64  
 1   communityname          1994 non-null   object 
 2   population             1994 non-null   float64
 3   householdsize          1994 non-null   float64
 4   racepctblack           1994 non-null   float64
 5   racePctWhite           1994 non-null   float64
 6   racePctAsian           1994 non-null   float64
 7   racePctHisp            1994 non-null   float64
 8   agePct12t21            1994 non-null   float64
 9   agePct12t29            1994 non-null   float64
 10  agePct16t24            1994 non-null   float64
 11  agePct65up             1994 non-null   float64
 12  numbUrban              1994 non-null   float64
 13  pctUrban               1994 non-null   float64
 14  medIncome              1994 non-null   float64
 15  pctWWage               1994 non-null   float64
 16  pctWFarmSelf           1994 non-null   float64
 17  pctWInvInc             1994 non-null   float64
 18  pctWSocSec             1994 non-null   float64
 19  pctWPubAsst            1994 non-null   float64
 20  pctWRetire             1994 non-null   float64
 21  medFamInc              1994 non-null   float64
 22  perCapInc              1994 non-null   float64
 23  whitePerCap            1994 non-null   float64
 24  blackPerCap            1994 non-null   float64
 25  indianPerCap           1994 non-null   float64
 26  AsianPerCap            1994 non-null   float64
 27  OtherPerCap            1994 non-null   float64
 28  HispPerCap             1994 non-null   float64
 29  NumUnderPov            1994 non-null   float64
 30  PctPopUnderPov         1994 non-null   float64
 31  PctLess9thGrade        1994 non-null   float64
 32  PctNotHSGrad           1994 non-null   float64
 33  PctBSorMore            1994 non-null   float64
 34  PctUnemployed          1994 non-null   float64
 35  PctEmploy              1994 non-null   float64
 36  PctEmplManu            1994 non-null   float64
 37  PctEmplProfServ        1994 non-null   float64
 38  MalePctDivorce         1994 non-null   float64
 39  MalePctNevMarr         1994 non-null   float64
 40  FemalePctDiv           1994 non-null   float64
 41  TotalPctDiv            1994 non-null   float64
 42  PersPerFam             1994 non-null   float64
 43  PctFam2Par             1994 non-null   float64
 44  PctKids2Par            1994 non-null   float64
 45  PctYoungKids2Par       1994 non-null   float64
 46  PctTeen2Par            1994 non-null   float64
 47  PctWorkMomYoungKids    1994 non-null   float64
 48  PctWorkMom             1994 non-null   float64
 49  NumIlleg               1994 non-null   float64
 50  PctIlleg               1994 non-null   float64
 51  NumImmig               1994 non-null   float64
 52  PctImmigRecent         1994 non-null   float64
 53  PctImmigRec5           1994 non-null   float64
 54  PctImmigRec8           1994 non-null   float64
 55  PctImmigRec10          1994 non-null   float64
 56  PctRecentImmig         1994 non-null   float64
 57  PctRecImmig5           1994 non-null   float64
 58  PctRecImmig8           1994 non-null   float64
 59  PctRecImmig10          1994 non-null   float64
 60  PctSpeakEnglOnly       1994 non-null   float64
 61  PctNotSpeakEnglWell    1994 non-null   float64
 62  PctLargHouseFam        1994 non-null   float64
 63  PctLargHouseOccup      1994 non-null   float64
 64  PersPerOccupHous       1994 non-null   float64
 65  PersPerOwnOccHous      1994 non-null   float64
 66  PersPerRentOccHous     1994 non-null   float64
 67  PctPersOwnOccup        1994 non-null   float64
 68  PctPersDenseHous       1994 non-null   float64
 69  PctHousLess3BR         1994 non-null   float64
 70  MedNumBR               1994 non-null   float64
 71  HousVacant             1994 non-null   float64
 72  PctHousOccup           1994 non-null   float64
 73  PctHousOwnOcc          1994 non-null   float64
 74  PctVacantBoarded       1994 non-null   float64
 75  PctVacMore6Mos         1994 non-null   float64
 76  MedYrHousBuilt         1994 non-null   float64
 77  PctHousNoPhone         1994 non-null   float64
 78  PctWOFullPlumb         1994 non-null   float64
 79  OwnOccLowQuart         1994 non-null   float64
 80  OwnOccMedVal           1994 non-null   float64
 81  OwnOccHiQuart          1994 non-null   float64
 82  RentLowQ               1994 non-null   float64
 83  RentMedian             1994 non-null   float64
 84  RentHighQ              1994 non-null   float64
 85  MedRent                1994 non-null   float64
 86  MedRentPctHousInc      1994 non-null   float64
 87  MedOwnCostPctInc       1994 non-null   float64
 88  MedOwnCostPctIncNoMtg  1994 non-null   float64
 89  NumInShelters          1994 non-null   float64
 90  NumStreet              1994 non-null   float64
 91  PctForeignBorn         1994 non-null   float64
 92  PctBornSameState       1994 non-null   float64
 93  PctSameHouse85         1994 non-null   float64
 94  PctSameCity85          1994 non-null   float64
 95  PctSameState85         1994 non-null   float64
 96  LandArea               1994 non-null   float64
 97  PopDens                1994 non-null   float64
 98  PctUsePubTrans         1994 non-null   float64
 99  ViolentCrimesPerPop    1994 non-null   float64
dtypes: float64(98), int64(1), object(1)
memory usage: 1.5+ MB
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[117]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">community</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[117]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>state</th>
      <td>1994.0</td>
      <td>28.683551</td>
      <td>16.397553</td>
      <td>1.0</td>
      <td>12.00</td>
      <td>34.00</td>
      <td>42.00</td>
      <td>56.0</td>
    </tr>
    <tr>
      <th>population</th>
      <td>1994.0</td>
      <td>0.057593</td>
      <td>0.126906</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>0.02</td>
      <td>0.05</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>householdsize</th>
      <td>1994.0</td>
      <td>0.463395</td>
      <td>0.163717</td>
      <td>0.0</td>
      <td>0.35</td>
      <td>0.44</td>
      <td>0.54</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>racepctblack</th>
      <td>1994.0</td>
      <td>0.179629</td>
      <td>0.253442</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.06</td>
      <td>0.23</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>racePctWhite</th>
      <td>1994.0</td>
      <td>0.753716</td>
      <td>0.244039</td>
      <td>0.0</td>
      <td>0.63</td>
      <td>0.85</td>
      <td>0.94</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>PctSameState85</th>
      <td>1994.0</td>
      <td>0.651530</td>
      <td>0.198221</td>
      <td>0.0</td>
      <td>0.56</td>
      <td>0.70</td>
      <td>0.79</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>LandArea</th>
      <td>1994.0</td>
      <td>0.065231</td>
      <td>0.109459</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.04</td>
      <td>0.07</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>PopDens</th>
      <td>1994.0</td>
      <td>0.232854</td>
      <td>0.203092</td>
      <td>0.0</td>
      <td>0.10</td>
      <td>0.17</td>
      <td>0.28</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>PctUsePubTrans</th>
      <td>1994.0</td>
      <td>0.161685</td>
      <td>0.229055</td>
      <td>0.0</td>
      <td>0.02</td>
      <td>0.07</td>
      <td>0.19</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>ViolentCrimesPerPop</th>
      <td>1994.0</td>
      <td>0.237979</td>
      <td>0.232985</td>
      <td>0.0</td>
      <td>0.07</td>
      <td>0.15</td>
      <td>0.33</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>99 rows &#215; 8 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[118]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Removing the State adn CommunityName</span>
<span class="n">comm_table</span> <span class="o">=</span> <span class="n">community</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:]</span>
<span class="n">comm_table</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[118]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>householdsize</th>
      <th>racepctblack</th>
      <th>racePctWhite</th>
      <th>racePctAsian</th>
      <th>racePctHisp</th>
      <th>agePct12t21</th>
      <th>agePct12t29</th>
      <th>agePct16t24</th>
      <th>agePct65up</th>
      <th>...</th>
      <th>NumStreet</th>
      <th>PctForeignBorn</th>
      <th>PctBornSameState</th>
      <th>PctSameHouse85</th>
      <th>PctSameCity85</th>
      <th>PctSameState85</th>
      <th>LandArea</th>
      <th>PopDens</th>
      <th>PctUsePubTrans</th>
      <th>ViolentCrimesPerPop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.19</td>
      <td>0.33</td>
      <td>0.02</td>
      <td>0.90</td>
      <td>0.12</td>
      <td>0.17</td>
      <td>0.34</td>
      <td>0.47</td>
      <td>0.29</td>
      <td>0.32</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.12</td>
      <td>0.42</td>
      <td>0.50</td>
      <td>0.51</td>
      <td>0.64</td>
      <td>0.12</td>
      <td>0.26</td>
      <td>0.20</td>
      <td>0.20</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.00</td>
      <td>0.16</td>
      <td>0.12</td>
      <td>0.74</td>
      <td>0.45</td>
      <td>0.07</td>
      <td>0.26</td>
      <td>0.59</td>
      <td>0.35</td>
      <td>0.27</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.21</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.60</td>
      <td>0.52</td>
      <td>0.02</td>
      <td>0.12</td>
      <td>0.45</td>
      <td>0.67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.00</td>
      <td>0.42</td>
      <td>0.49</td>
      <td>0.56</td>
      <td>0.17</td>
      <td>0.04</td>
      <td>0.39</td>
      <td>0.47</td>
      <td>0.28</td>
      <td>0.32</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.14</td>
      <td>0.49</td>
      <td>0.54</td>
      <td>0.67</td>
      <td>0.56</td>
      <td>0.01</td>
      <td>0.21</td>
      <td>0.02</td>
      <td>0.43</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.04</td>
      <td>0.77</td>
      <td>1.00</td>
      <td>0.08</td>
      <td>0.12</td>
      <td>0.10</td>
      <td>0.51</td>
      <td>0.50</td>
      <td>0.34</td>
      <td>0.21</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.19</td>
      <td>0.30</td>
      <td>0.73</td>
      <td>0.64</td>
      <td>0.65</td>
      <td>0.02</td>
      <td>0.39</td>
      <td>0.28</td>
      <td>0.12</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.01</td>
      <td>0.55</td>
      <td>0.02</td>
      <td>0.95</td>
      <td>0.09</td>
      <td>0.05</td>
      <td>0.38</td>
      <td>0.38</td>
      <td>0.23</td>
      <td>0.36</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.11</td>
      <td>0.72</td>
      <td>0.64</td>
      <td>0.61</td>
      <td>0.53</td>
      <td>0.04</td>
      <td>0.09</td>
      <td>0.02</td>
      <td>0.03</td>
    </tr>
  </tbody>
</table>
<p>5 rows &#215; 98 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[119]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Seperate the target varible </span>
<span class="n">target</span> <span class="o">=</span> <span class="n">comm_table</span><span class="o">.</span><span class="n">ViolentCrimesPerPop</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">comm_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[120]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[121]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Splitting the training and testing data.</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span><span class="mi">33</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[122]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">Y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>(1595, 97)
(399, 97)
(1595,)
(399,)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Question 2<a rel="noopener" class="anchor-link" href="#Question-2">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Perform standard multiple linear regression on data using the scikit-learn Linear Regression module. Compute the RMSE values on the full training data (the 80% partition). Also, plot the correlation between the predicted and actual values of the target attribute. Display the obtained regression coefficients (weights) and plot them using matplotlib. Finally, perform 10-fold cross-validation on the training partition and compare the cross-validation RMSE to the training RMSE (for cross validation, you should use the KFold module from sklearn.model_selection).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[123]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[124]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[124]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[125]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#finidng prediction for training data</span>
<span class="n">p_train</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[126]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1">#Computing RMSE for train data</span>
<span class="n">rmse_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">p_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMSE on Test Data: &quot;</span><span class="p">,</span> <span class="n">rmse_train</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>RMSE on Test Data:  0.1261959313342669
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[127]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting correlation between predicted and actual training target variable</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span><span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;g-&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Actual&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[128]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting the regression wieghts</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="k">def</span> <span class="nf">plot_coefficients</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">feature_names</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Coefficient Value&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Feature&quot;</span><span class="p">)</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[135]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Plotting the coefficients</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

<span class="n">plot_coefficients</span><span class="p">(</span><span class="n">linreg</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[136]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#10 fold cross-validation </span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[137]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">linreg</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span><span class="s2">&quot;neg_mean_squared_error&quot;</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
<span class="n">cv_rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">cv_scores</span><span class="p">)))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[0.14373935 0.13848502 0.13298995 0.1360245  0.1351074  0.13231055
 0.11917148 0.12158482 0.13669634 0.14684537]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[138]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">method_name</span> <span class="o">=</span> <span class="s1">&#39;Simple Linear Regression&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Method: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">method_name</span>)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE on training: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">rmse_train</span>)
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RMSE on 10-fold CV: </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">cv_rmse</span>)
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Method: Simple Linear Regression
RMSE on training: 0.1262
RMSE on 10-fold CV: 0.1343
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>RMSE performed better without 10-fold CV<a rel="noopener" class="anchor-link" href="#RMSE-performed-better-without-10-fold-CV">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Question 1-C<a rel="noopener" class="anchor-link" href="#Question-1-C">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>[15 pts] Feature Selection:  use the scikit-learn to select the best subset of features to perform linear regression. For feature selection, write a script or function that takes as input the training data; target variable; the regression model; and any other parameters you find necessary. The function should return the optimal percentage of the most informative features to use. Your approach should use k-fold cross-validation on the training data (use k=5 for consistency) and use feature_selection.SelectPercentile to find the most informative variables for a range of percentile values [Note: since this is regression not classification, in the SelectPercentile function you should use feature_selection.f_regression as scoring function rather than chi2). You should also plot the model&#39;s error values on cross-validation using only the selected features across the range of percentile values. For variety, in this part we will use Mean Absolute Error (MAE) as the error metric instead of RMSE. For cross-validation, use scikit&#39;s cross_val_score function. In order to use cross_val_score with regression you&#39;ll need to pass to it a specific error function. In this case, you will use scoring=&#39;neg_mean_absolute_error&#39; as a parameter. You should use aboslute values to convert these negated MAE values to positive MAE values. Your plot should look similar (but won&#39;t be exactly the same as this example). Once you have identified the best percentile based on cross-validation, use it to identify and display the corresponding best features. As a final step, train your model on the full 80% training data with the optimal subset of features and then compute it&#39;s peformance (again using MAE) on the set-aside 20% test partitio</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[139]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Univariate linear regression tests returning F-statistic and p-value</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">feature_selection</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[147]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">f_regression</span><span class="p">,</span> <span class="n">SelectPercentile</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[148]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">feature_selection</span><span class="o">.</span><span class="n">SelectPercentile</span><span class="p">(</span><span class="n">feature_selection</span><span class="o">.</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">percentile</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">X_train_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train_fs</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>[[0.02 0.91 0.83 ... 0.83 0.   0.01]
 [0.59 0.44 0.44 ... 0.31 0.86 0.33]
 [0.02 0.95 0.75 ... 0.86 0.04 0.02]
 ...
 [0.23 0.76 0.77 ... 0.78 0.   0.03]
 [0.09 0.77 0.42 ... 0.24 0.04 0.06]
 [1.   0.   0.37 ... 0.23 1.   0.25]]
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[159]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span> 


<span class="n">linreg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">percentiles</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">scorer</span> <span class="o">=</span><span class="s1">&#39;neg_mean_absolute_error&#39;</span>
<span class="n">N</span> <span class="o">=</span><span class="mi">5</span>

<span class="k">def</span> <span class="nf">optimal_num_features</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">percentile</span><span class="p">,</span> <span class="n">scorer</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">percentiles</span><span class="p">:</span>
        <span class="n">fs</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
        <span class="n">X_train_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train_fs</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">scoring</span> <span class="o">=</span> <span class="n">scorer</span><span class="p">))</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

    <span class="n">optimal_percentile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">results</span> <span class="o">==</span> <span class="n">results</span><span class="o">.</span><span class="n">min</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Optimal percentile of features:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percentile</span><span class="p">)]))</span>
    <span class="k">return</span> <span class="n">optimal_percentile</span><span class="p">,</span> <span class="n">results</span>

<span class="n">optimal_percent</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">optimal_num_features</span><span class="p">(</span><span class="n">linreg</span><span class="p">,</span><span class="n">X_train</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">N</span><span class="p">,</span><span class="n">percentiles</span><span class="p">,</span><span class="n">scorer</span><span class="p">)</span>

<span class="n">optimal_num_features</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)]</span><span class="o">*</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">optimal_percent : &quot;</span><span class="p">,</span><span class="n">optimal_percent</span><span class="p">,</span><span class="s2">&quot; Optimal number of features:</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">optimal_num_features</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot percentile of features VS. cross-validation scores</span>
<span class="kn">import</span> <span class="nn">pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="n">pl</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Percentile of features VS cross-validation score&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Percentage of features selected&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross validation accuracy&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">percentiles</span><span class="p">,</span><span class="n">results</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>1 0.11287401163402822
6 0.09943268475677308
11 0.09900510519125442
16 0.09909059079526811
21 0.0975068622131086
26 0.09608904536542379
31 0.09478480270197638
36 0.09474955355002235
41 0.09435370428857698
46 0.09466441760571029
51 0.0949877334678105
56 0.0953208516480594
61 0.09574966889254502
66 0.09572089544915725
71 0.09583132229767206
76 0.09519157369784723
81 0.0954256882753639
86 0.09513624310358182
91 0.09525366581598065
96 0.09527627852883909
Optimal percentile of features:41

optimal_percent :  [8]  Optimal number of features:39 

</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[159]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>[&lt;matplotlib.lines.Line2D at 0x7f93b9008220&gt;]</pre>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[180]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal_percent &quot;</span><span class="p">,</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span><span class="n">percentile</span><span class="o">=</span><span class="n">percentiles</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">optimal_percent</span><span class="p">)])</span>
<span class="n">X_train_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">fs</span><span class="o">.</span><span class="n">get_support</span><span class="p">()[</span><span class="n">i</span><span class="p">]:</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">scores_</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>optimal_percent  41

population 	 256.03235473720673
racepctblack 	 1074.8895092675361
racePctWhite 	 1412.5078123923954
numbUrban 	 247.77613854814695
medIncome 	 341.6325375231909
pctWWage 	 161.5707509415729
pctWInvInc 	 756.0149723312808
pctWPubAsst 	 784.5706408092502
medFamInc 	 366.9004218440602
perCapInc 	 214.99315799068873
NumUnderPov 	 400.3078568907995
PctPopUnderPov 	 578.817365213768
PctLess9thGrade 	 319.21810810192545
PctNotHSGrad 	 472.1962078690551
PctBSorMore 	 173.36684318428337
PctUnemployed 	 533.9131521991883
PctEmploy 	 190.46526246383803
MalePctDivorce 	 602.774893581606
FemalePctDiv 	 704.7727390048287
TotalPctDiv 	 693.1378303821938
PctFam2Par 	 1657.8650169980986
PctKids2Par 	 1972.8040638664002
PctYoungKids2Par 	 1342.173613787548
PctTeen2Par 	 1299.5351058426786
NumIlleg 	 431.63556026914654
PctIlleg 	 1936.1208737827078
PctLargHouseFam 	 241.23381636029765
PctPersOwnOccup 	 630.760339373988
PctPersDenseHous 	 375.6459018761194
PctHousLess3BR 	 487.96168084239935
MedNumBR 	 242.0664299478884
HousVacant 	 339.96861816208923
PctHousOccup 	 173.73941701732457
PctHousOwnOcc 	 478.53042971844667
PctVacantBoarded 	 507.63640854198803
PctHousNoPhone 	 505.8626527468836
PctWOFullPlumb 	 209.11490495589393
MedRentPctHousInc 	 178.68419423618857
NumInShelters 	 265.84594187525676
NumStreet 	 169.53426122290603
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The optimal percentile of features is 41 with CV accuracy of 0.0943. The optimal number of features are 39.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[226]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="n">SelectPercentile</span><span class="p">(</span><span class="n">f_regression</span><span class="p">,</span> <span class="n">optimal_percent</span><span class="p">)</span>
<span class="n">X_train_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">linreg</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">linreg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_fs</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">X_test_fs</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">predict</span> <span class="o">=</span> <span class="n">linreg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_fs</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">predict</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAE score for test data on cv: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">score</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>MAE score for test data on cv: 0.024076717731537724
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/Users/vinodpatel/opt/anaconda3/lib/python3.9/site-packages/sklearn/utils/validation.py:70: FutureWarning: Pass percentile=[8] as keyword args. From version 1.0 (renaming of 0.25) passing these as positional arguments will result in an error
  warnings.warn(f&quot;Pass {args_msg} as keyword args. From version &quot;
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 1-D<a rel="noopener" class="anchor-link" href="#Que-1-D">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Next, using the original train and test data in part (a), perform Ridge Regression and Lasso Regression using the modules from sklearn.linear_model. In each case, perform systematic model selection to identify the optimal alpha hyperparameter (the regularization coefficient). You should create a function that takes as input the training data and target variable; the parameter to vary and a list of its values; the model to be trained; and any other relevant input needed to determine the optimal value for the specified parameter. The model selection process should perform k-fold cross validation (k should be a parameter, but you can select k=5 for this problem). For each model, you should also plot the error values (this time using RMSE as the error metric) on the training and cross-validation splits across the specified values of alpha. Finally, using the best alpha values for each regression model, train the model on the full training data and evaluate it on the set-aside test data. Discuss your observations and conclusions, especially about the impact of alpha on bias-variance trade-off. [Hint: for an example of a similar model optimization process please review the class example notebook.]</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[227]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Ridge Regression </span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[230]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calc_params</span><span class="p">(</span><span class="n">Data</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">param_values</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    
    <span class="c1"># Convert input to Numpy arrays</span>
    <span class="n">Data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Data</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># initialize training and testing score arrays with zeros</span>
    <span class="n">train_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">))</span>
    <span class="n">test_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">param_values</span><span class="p">))</span>
    
    <span class="c1"># iterate over the different parameter values</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">param_values</span><span class="p">):</span>
        
        <span class="c1"># set classifier parameters</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">param_name</span><span class="p">:</span><span class="n">param_value</span><span class="p">})</span>
        
        <span class="c1"># initialize the K scores obtained for each fold</span>
        <span class="n">k_train_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        <span class="n">k_test_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
        
        <span class="c1"># create KFold cross validation</span>
        <span class="n">cv</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># iterate over the K folds</span>
        <span class="k">for</span> <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="ow">in</span> <span class="n">cv</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">Data</span><span class="p">):</span>
            <span class="c1"># fit the classifier in the corresponding fold</span>
            <span class="c1"># and obtain the corresponding accuracy scores on train and test sets</span>
            <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train</span><span class="p">])</span>
            
            <span class="n">train_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">train</span><span class="p">])</span>
            <span class="n">test_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Data</span><span class="p">[</span><span class="n">test</span><span class="p">])</span>
            
            <span class="n">k_train_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">train</span><span class="p">],</span> <span class="n">train_predict</span><span class="p">))</span>
            <span class="n">k_test_scores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">test</span><span class="p">],</span> <span class="n">test_predict</span><span class="p">))</span>

        
        <span class="c1"># store the mean of the K fold scores</span>
        <span class="n">train_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">k_train_scores</span><span class="p">)</span>
        <span class="n">test_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">k_test_scores</span><span class="p">)</span>
       
    <span class="c1"># plot the training and testing scores in a log scale</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">train_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">param_name</span> <span class="o">+</span> <span class="s2">&quot; values&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cross validation RMSE&quot;</span><span class="p">)</span>

    <span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">test_scores</span> <span class="o">==</span> <span class="n">test_scores</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
    <span class="n">min_err_alpha</span> <span class="o">=</span> <span class="n">param_values</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">]</span>
    
    <span class="c1">##print (&#39;The minimum MAE using cross validation is:&#39;, test_scores[min_err_idx][0],&#39;with&#39;, param_name,&#39;:&#39;, min_err_alpha[0])</span>
    
    <span class="c1"># return the training and testing scores on each parameter value</span>
    <span class="k">return</span> <span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[231]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39; train shape &#39;</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s1">&#39; y-train shape &#39;</span><span class="p">,</span><span class="n">Y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">])</span>

<span class="n">number_of_fold</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">param_name</span> <span class="o">=</span> <span class="s1">&#39;alpha&#39;</span>
<span class="n">param_values</span> <span class="o">=</span> <span class="n">alpha</span>
<span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">models</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Ridge&#39;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span><span class="s1">&#39;Lasso&#39;</span><span class="p">:</span><span class="n">Lasso</span><span class="p">()}</span>
<span class="n">min_alpha</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    
    <span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">calc_params</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">models</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="n">param_values</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">number_of_fold</span><span class="p">,</span><span class="n">verbose</span><span class="p">,</span><span class="n">key</span><span class="p">)</span>
    
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1"> The minimum RMSE for </span><span class="se">\&quot;</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\&quot;</span><span class="s1"> using cross validation is:&#39;</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">min_alpha</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">=</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> train shape  (1595, 97)  y-train shape  (1595,)


 The minimum RMSE for &quot; Ridge &quot; using cross validation is: 0.13882110895925442 with alpha : 1.0060150753768842


 The minimum RMSE for &quot; Lasso &quot; using cross validation is: 0.14224582056412474 with alpha : 0.001
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[243]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;############################### running the models on Test #######################################&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="kc">None</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">min_alpha</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">if</span><span class="p">(</span><span class="n">key</span><span class="o">==</span><span class="s1">&#39;Ridge&#39;</span><span class="p">):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>    
       
    <span class="k">else</span> <span class="p">:</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>    
        
      
    <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s1">&#39; =&gt; Root Mean Squared error on test data: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">RMSE</span><span class="p">,</span> <span class="s1">&#39;using alpha =&#39;</span><span class="p">,</span><span class="n">min_alpha</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>############################### running the models on Test #######################################
Ridge  =&gt; Root Mean Squared error on test data: 0.14337675 using alpha = 1.0060150753768842
Lasso  =&gt; Root Mean Squared error on test data: 0.14601641 using alpha = 0.001
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 1-E<a rel="noopener" class="anchor-link" href="#Que-1-E">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Next, perform regression using Stochastic Gradient Descent Regressor from scikit-learn (again use the original train-test split in part (a). Note that SGDRegessor requires that features be standardized (with 0 mean and scaled by standard deviation). Prior to fiting the model, perform the scaling using StandardScaler from sklearn.preprocessing. For this problem, perform a grid search (using GridSearchCV from sklearn.grid_search). Your grid search should compare combinations of two penalty parameters (&#39;l2&#39;, &#39;l1&#39;) and different values of alpha (alpha could vary from 0.0001 which is the default to relatively large values, say 10). Using the best parameters, train the model on the full training partition and apply the model to the set-aside test data, comparing traning and test RMSE scores. Finally, perform model optimization (similar to part d, above) to find the best &quot;l1_ratio&quot; parameter using SGDRegressor with  the &quot;elasticnet&quot; penalty parameter. [Note: &quot;l1_ratio&quot; is The Elastic Net mixing parameter, with 0 &lt;= l1_ratio &lt;= 1;  l1_ratio=0 corresponds to L2 penalty, l1_ratio=1 to L1 penalty; defaults to 0.15.] Using the best mixing ratio, apply the Elastic Net model, trained on full training data, to the set-aside test data and compare to the training perfromance. Provide a brief summary of your findings from the above experiments.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[250]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[251]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;input data Shape&#39;</span><span class="p">,</span><span class="n">community</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">vs_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">community</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;communityname&#39;</span><span class="p">,</span><span class="s1">&#39;ViolentCrimesPerPop&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="c1"># Standardize the data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">)</span>
<span class="n">vs_matrix</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">)</span>


<span class="n">vs_train</span><span class="p">,</span> <span class="n">vs_test</span><span class="p">,</span> <span class="n">vs_target_train</span><span class="p">,</span> <span class="n">vs_target_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">vs_matrix</span><span class="p">,</span> <span class="n">community</span><span class="o">.</span><span class="n">ViolentCrimesPerPop</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vs_train shape &quot;</span><span class="p">,</span><span class="n">vs_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">&quot; test shape &quot;</span><span class="p">,</span><span class="n">vs_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train target shape &quot;</span><span class="p">,</span><span class="n">vs_target_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot; Test target shape &quot;</span><span class="p">,</span><span class="n">vs_target_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">x_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_train</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_target_train</span><span class="p">)</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_test</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vs_target_test</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>input data Shape (1994, 100)
vs_train shape  (1595, 97)  test shape  (399, 97)
train target shape  (1595,)  Test target shape  (399,)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[252]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sgdreg</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">();</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">.0001</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">alpha</span><span class="p">])</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;penalty&#39;</span><span class="p">:[</span><span class="s2">&quot;l2&quot;</span><span class="p">,</span><span class="s2">&quot;l1&quot;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="n">alpha</span>
<span class="p">}</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">sgdreg</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[254]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">time</span> _ = gs.fit(X_train, Y_train)

<span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_score_</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Fitting 5 folds for each of 200 candidates, totalling 1000 fits
CPU times: user 23.8 s, sys: 305 ms, total: 24.1 s
Wall time: 12.7 s
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[254]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>({&#39;alpha&#39;: 0.0001, &#39;penalty&#39;: &#39;l1&#39;}, 0.6410489261073014)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[255]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Using the best parameters, apply the model to the set-aside test data</span>
<span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">()</span>

<span class="n">val</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">gs</span><span class="o">.</span><span class="n">best_params_</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">sgd</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">})</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;The optimum value of&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;is estimated as&quot;</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
    <span class="n">val</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">sgd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sgd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;RMSE on set-aside test data set: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">RMSE</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>The optimum value of alpha is estimated as 0.0001


The optimum value of penalty is estimated as l1


RMSE on set-aside test data set: 0.32229459 with alpha=0.0001 penalty=l1 
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[256]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">l1_ratio_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">param_name</span> <span class="o">=</span> <span class="s2">&quot;l1_ratio&quot;</span> 
<span class="n">param_value</span> <span class="o">=</span> <span class="n">l1_ratio_range</span>
<span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">)</span>

<span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">,</span><span class="n">min_err_idx</span> <span class="o">=</span> <span class="n">calc_params</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span><span class="n">model</span><span class="p">,</span> <span class="n">param_value</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="s2">&quot;SGDRegressor&quot;</span><span class="p">)</span>
    
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1"> The minimum RMSE for </span><span class="se">\&quot;</span><span class="s1">SGDRegressor</span><span class="se">\&quot;</span><span class="s1"> using cross validation is:&#39;</span><span class="p">,</span> <span class="n">test_scores</span><span class="p">[</span><span class="n">min_err_idx</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;with&#39;</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>

 The minimum RMSE for &quot;SGDRegressor&quot; using cross validation is: 0.14360631095687407 with l1_ratio : 0.9393999999999999
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h6>From above output, we can say that the l1_ratio value of 0.4141 gives the lowest RMSE on training data (0.137 ). So, we will use that to run the model on set aside test data with &quot;elasticnet&quot; as the penalty parameter.<a rel="noopener" class="anchor-link" href="#From-above-output,-we-can-say-that-the-l1_ratio-value-of-0.4141-gives-the-lowest-RMSE-on-training-data-(0.137-).-So,-we-will-use-that-to-run-the-model-on-set-aside-test-data-with-%22elasticnet%22-as-the-penalty-parameter.">&#182;</a></h6>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[257]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Using the best parameters, apply the model to the set-aside test data</span>
<span class="n">sgd</span> <span class="o">=</span> <span class="n">SGDRegressor</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;elasticnet&#39;</span><span class="p">,</span> <span class="n">l1_ratio</span><span class="o">=</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sgd</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">sgd</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">MAE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;MAE on set-aside test data set: </span><span class="si">%0.8f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">MAE</span><span class="p">,</span> <span class="s2">&quot;with penalty equals to &#39;elasticnet&#39; and l1_ratio = &quot;</span><span class="p">,</span><span class="n">min_err_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>MAE on set-aside test data set: 0.32172464 with penalty equals to &#39;elasticnet&#39; and l1_ratio =  0.9393999999999999
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>RMSE on Train Data<a rel="noopener" class="anchor-link" href="#RMSE-on-Train-Data">&#182;</a></h1>
</div>
</div>Ridge ==&gt; 0.1388
Lasso ==&gt; 0.1422
SGB ==&gt; 0.1437
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>RMSE on Test Data<a rel="noopener" class="anchor-link" href="#RMSE-on-Test-Data">&#182;</a></h1>
</div>
</div>Ridge ==&gt; 0.1433
Lasso ==&gt; 0.146
SGB ==&gt; 0.3217RMSE for Lasso and Ridge were almost same. 
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 2-A<a rel="noopener" class="anchor-link" href="#Que-2-A">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Create your own distance function that, instead of using Euclidean distance, uses Cosine similarity. This is the distance function you will use to pass to the kMeans function in the included module. Note: you should not use external function for computing Cosine. Write your own version that computes Cosine similarity between two n-dimentional vectors and returns the inverse as the distance between these vectors.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[259]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[260]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">calculateEuclideanDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">D</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dist</span>

<span class="k">def</span> <span class="nf">calculateCosineSimilarityDistance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">D</span><span class="p">):</span>
    
    <span class="n">D_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="c1">#np.array([np.linalg.norm(D[i]) for i in range(len(D))])</span>
    <span class="n">x_norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1">#print(&quot;D_norm &quot;,D_norm,&quot; x_norm &quot;,x_norm)</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">D_norm</span> <span class="o">*</span> <span class="n">x_norm</span><span class="p">)</span>
    <span class="c1"># The distance measure will be the inverse of Cosine similarity</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">sims</span>
    
    <span class="k">return</span> <span class="n">dist</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 2-B<a rel="noopener" class="anchor-link" href="#Que-2-B">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Load the data set [Note: the data matrix provided has terms as rows and documents as columns. Since you will be clustering documents, you&#39;ll need to take the transpose of this matrix so that your main data matrix is a document x term matrix. In Numpy, you may use the &quot;.T&quot; operation to obtain the transpose.] Then, use the train_test_split function (with random_state = 99) to perform a randomized split the data set (the document by term matrix) and set aside 20% for later use (see below). Use the 80% segment for clustering in the next part. Next, as in the previous assignment, perform TFxIDF transformation on these data sets. [Note: if you have difficulty with TFxIDF conversion, then use the original non-transformed data for the remainder of this assignment].</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[261]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;/Users/vinodpatel/Desktop/DePaul/DSC 478 Programming machine learning/Hw3/newsgroups5/matrix.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">terms</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="s2">&quot;/Users/vinodpatel/Desktop/DePaul/DSC 478 Programming machine learning/Hw3/newsgroups5/terms.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="s2">&quot;/Users/vinodpatel/Desktop/DePaul/DSC 478 Programming machine learning/Hw3/newsgroups5/classes.txt&quot;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">skip_header</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[262]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">matrix</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[262]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>2490</th>
      <th>2491</th>
      <th>2492</th>
      <th>2493</th>
      <th>2494</th>
      <th>2495</th>
      <th>2496</th>
      <th>2497</th>
      <th>2498</th>
      <th>2499</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9323</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9324</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9325</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9326</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9327</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>9328 rows &#215; 2500 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[263]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">terms</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[263]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>aa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>aargh</td>
    </tr>
    <tr>
      <th>2</th>
      <td>aaron</td>
    </tr>
    <tr>
      <th>3</th>
      <td>aaronc</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ab</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>9323</th>
      <td>zubov</td>
    </tr>
    <tr>
      <th>9324</th>
      <td>zv</td>
    </tr>
    <tr>
      <th>9325</th>
      <td>zw</td>
    </tr>
    <tr>
      <th>9326</th>
      <td>zx</td>
    </tr>
    <tr>
      <th>9327</th>
      <td>zz</td>
    </tr>
  </tbody>
</table>
<p>9328 rows &#215; 1 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[264]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">classes</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[264]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([0, 1, 1, ..., 3, 4, 2])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[265]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matrix Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Terms Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">terms</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Classes Shape: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">classes</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Matrix Shape: (9328, 2500)
Terms Shape: (9328, 1)
Classes Shape: (2500,)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[266]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">matrixT</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
<span class="n">matrixT</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[266]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(2500, 9328)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[267]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">DTmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">matrixT</span><span class="p">)</span>
<span class="n">DTmatrix</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[267]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(2500, 9328)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[268]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[272]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">ytest</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">matrixT</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[273]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train : &quot;</span><span class="p">,</span><span class="n">x_train</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test : &quot;</span><span class="p">,</span><span class="n">x_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>train :  (2000, 9328)
Test :  (500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 2-C<a rel="noopener" class="anchor-link" href="#Que-2-C">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Perform Kmeans clustering on the transformed training data from part (b) Perform a qualitative analysis of the clusters by examining top features in each cluster and identifying patterns in the data. To facilitate your analysis of the clusters, write a function to display the top N terms in each cluster sorted by the cluster DF values for each term, the centroid weights for each term in the top N terms in the cluster (mean TFxIDF weight of the term), and the size of the cluster. The cluster DF value for a term t in a cluster C is the percentage of docs in cluster C in which term t appears (so, if a cluster has 500 documents, and term &quot;game&quot; appears in 100 of those 500 documents, then DF value of &quot;game&quot; in that cluster is 0.2 or 20%). Sort the terms for each cluster in decreasing order of the DF percentage. Here is an example of how this output might look like (here the top 10 terms for a sample of clusters are displayed in decreasing order of cluster DF values, but the mean frequency (mean TFxIDF values) from the cluster centroid is also shown).</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[274]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">## get random centroids</span>
<span class="k">def</span> <span class="nf">randCent</span><span class="p">(</span><span class="n">dataSet</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">dataSet</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> <span class="c1">#create random cluster centers</span>
        <span class="n">minJ</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span>
        <span class="n">rangeJ</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">dataSet</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span> <span class="o">-</span> <span class="n">minJ</span><span class="p">)</span>
        <span class="n">centroids</span><span class="p">[:,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">minJ</span> <span class="o">+</span> <span class="n">rangeJ</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[275]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">kmeans</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">distMeas</span><span class="o">=</span><span class="n">calculateCosineSimilarityDistance</span><span class="p">,</span><span class="n">createCentroid</span> <span class="o">=</span> <span class="n">randCent</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">D</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="c1">## cluster assignment matrix with 2 cols. one for cluster index and 2nd one for cluster error (distance from cluster centroid to the current point)</span>
    <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calculating centroids : Start&#39;</span><span class="p">)</span>
    <span class="n">centroids</span> <span class="o">=</span> <span class="n">createCentroid</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;calculating centroids : End&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> centroids are :: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
    <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">clusterChanged</span><span class="p">:</span>
        <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1">## loop over data points and assign assign it to the closest centroid</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
            <span class="n">minDIst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">;</span>
            <span class="n">minIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
                <span class="n">distJI</span> <span class="o">=</span> <span class="n">distMeas</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">j</span><span class="p">,:],</span><span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
    
                <span class="k">if</span><span class="p">(</span><span class="n">distJI</span> <span class="o">&lt;</span> <span class="n">minDIst</span><span class="p">):</span>
                    <span class="n">minDIst</span> <span class="o">=</span> <span class="n">distJI</span><span class="p">;</span>
                    <span class="n">minIndex</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
            <span class="k">if</span> <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span><span class="n">minIndex</span> <span class="p">:</span> <span class="n">clusterChanged</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">clusterAssment</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">minIndex</span><span class="p">,</span> <span class="n">minDIst</span><span class="o">**</span><span class="mi">2</span>
        
        <span class="c1">## update the centroid</span>
        <span class="k">for</span> <span class="n">cent</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
            <span class="n">ptsInClust</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">clusterAssment</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">cent</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">centroids</span><span class="p">[</span><span class="n">cent</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ptsInClust</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[276]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>calculating centroids : Start
calculating centroids : End 
 centroids are :: 
 [[ 0.62  0.68 14.12 ...  1.33  0.4   2.68]
 [ 0.67  0.18 27.54 ...  1.67  0.47  4.07]
 [ 0.49  0.97 38.95 ...  1.52  0.13  2.55]
 [ 0.24  0.14 33.58 ...  1.74  0.15  1.78]
 [ 0.78  0.14 25.67 ...  1.41  0.62  4.31]]
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/var/folders/y1/rcx3rhfx4dj1v_rvs8qnbc0c0000gn/T/ipykernel_33479/11797310.py:24: DeprecationWarning: setting an array element with a sequence. This was supported in some cases where the elements are arrays with a single element. For example `np.array([1, np.array([2])], dtype=int)`. In the future this will raise the same ValueError as `np.array([1, [2]], dtype=int)`.
  clusterAssment[i,:] = minIndex, minDIst**2
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 4min 20s, sys: 1.03 s, total: 4min 21s
Wall time: 4min 12s
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[277]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot; centroids shape&quot;</span><span class="p">,</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; clusterAssment shape &quot;</span><span class="p">,</span><span class="n">clusterAssment</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> centroids shape (5, 9328)
 clusterAssment shape  (2000, 2)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[278]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">cluster_report</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span> <span class="n">clusters</span><span class="p">,</span> <span class="n">centroids</span><span class="p">):</span>
    <span class="n">clustersDF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clusters</span><span class="p">)</span>
    <span class="n">term_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">terms</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Term&#39;</span><span class="p">)</span>
    
    <span class="n">cluster_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">clustersDF</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">size</span> <span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cluster_labels</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="c1">## get the index of the train data from cluster c</span>
        <span class="n">cl_data</span> <span class="o">=</span> <span class="n">x_train</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">clustersDF</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">]</span>

        <span class="c1"># gen centroids/frequency for the current (ith) cluster</span>
        <span class="n">centroid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">centroids</span><span class="p">[</span><span class="n">c</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Freq&#39;</span><span class="p">)</span>

        <span class="n">cl_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cl_data</span><span class="p">)</span>
        <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">cl_size</span>
        
        <span class="c1">## doc by term</span>
        <span class="n">docs_from_cluster</span> <span class="o">=</span> <span class="n">x_train</span><span class="p">[</span><span class="n">x_train</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">cl_data</span><span class="p">)]</span>

        <span class="c1">## term by doc</span>
        <span class="n">docs_from_cluster</span> <span class="o">=</span> <span class="n">docs_from_cluster</span><span class="o">.</span><span class="n">T</span>

        <span class="c1">## count all non zero terms</span>
        <span class="n">DF</span> <span class="o">=</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">docs_from_cluster</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

        <span class="c1">## if a cluster has 500 documents, and term &quot;game&quot; appears in 100 of those 500 documents, </span>
        <span class="c1">##then DF value of &quot;game&quot; in that cluster is 0.2 or 20%</span>
        <span class="n">DF</span> <span class="o">=</span> <span class="n">DF</span> <span class="o">/</span> <span class="n">size</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="c1">## divide each term count by number of docs in cluser</span>
        
        <span class="n">DF</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DF&#39;</span><span class="p">]</span>
        
        <span class="n">DF_PERCENT</span> <span class="o">=</span> <span class="n">DF</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">DF_PERCENT</span> <span class="o">=</span> <span class="n">DF_PERCENT</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">DF_PERCENT</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">% o</span><span class="s1">f Docs&#39;</span><span class="p">]</span>
        <span class="c1">##print(&quot;docs_from_cluster \n&quot;,docs_from_cluster)</span>

        <span class="c1">## concatenate the terms, centroid and DF values for the cluster</span>
        <span class="n">term_centroid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">term_list</span><span class="p">,</span> <span class="n">centroid</span><span class="p">,</span><span class="n">DF</span><span class="p">,</span><span class="n">DF_PERCENT</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">result</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">term_centroid</span>
    <span class="k">return</span> <span class="n">result</span> <span class="p">,</span> <span class="n">size</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[279]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">display_clusters</span><span class="p">(</span><span class="n">clusterDict</span><span class="p">,</span> <span class="n">clusterSize</span><span class="p">,</span> <span class="n">numTerms</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clusterDict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">cluster_rep</span> <span class="o">=</span> <span class="n">clusterDict</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Cluster &quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="s2">&quot;size =&quot;</span><span class="p">,</span> <span class="n">clusterSize</span><span class="p">[</span><span class="n">c</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;----------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">cluster_rep</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;DF&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">numTerms</span><span class="p">))</span>
    <span class="k">return</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[280]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">clusterDict_nonidf</span> <span class="p">,</span> <span class="n">clusterSize_nonidf</span> <span class="o">=</span> <span class="n">cluster_report</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span><span class="n">clusterAssment</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clusterDict_nonidf</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">cluster# :: # of docs&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">clusterSize_nonidf</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2"> :: &quot;</span><span class="p">,</span><span class="n">clusterSize_nonidf</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>1
2
4
dict_keys([1, 2, 4])

cluster# :: # of docs
1  	 ::  5
2  	 ::  394
4  	 ::  1601
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[281]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">numOfTopNTerms</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">display_clusters</span><span class="p">(</span><span class="n">clusterDict_nonidf</span><span class="p">,</span><span class="n">clusterSize_nonidf</span><span class="p">,</span><span class="n">numOfTopNTerms</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
Cluster  1 size = 5
----------------------------------------------
       Term  Freq   DF  % of Docs
443    asqq   5.0  1.0      100.0
2508     ei   8.2  1.0      100.0
3317   gkwt   3.2  1.0      100.0
744     bhj   4.6  1.0      100.0
1420  cliff   1.0  1.0      100.0
5680   nriz   4.0  1.0      100.0
5428    mwt   3.8  1.0      100.0
3385     gp   4.6  1.0      100.0
4835     ma   7.0  1.0      100.0
5426     mw  10.2  1.0      100.0

Cluster  2 size = 394
----------------------------------------------
         Term  Freq    DF  % of Docs
7895  subject  1.04  1.00     100.00
3198     game  1.75  0.57      56.85
9129    write  0.66  0.54      53.55
8098     team  1.22  0.46      46.45
3339       go  0.88  0.44      43.91
3708   hockei  0.76  0.43      42.89
417    articl  0.51  0.42      41.62
6186     plai  1.11  0.41      41.37
5795       on  0.63  0.38      38.32
3266      get  0.70  0.35      34.77

Cluster  4 size = 1601
----------------------------------------------
         Term  Freq    DF  % of Docs
7895  subject  1.09  1.00     100.00
9129    write  0.63  0.47      46.72
5795       on  0.80  0.39      39.48
417    articl  0.45  0.35      34.60
4449     know  0.50  0.31      30.54
3266      get  0.45  0.28      27.86
4319     just  0.41  0.27      27.48
8203    think  0.37  0.23      23.30
6049    peopl  0.48  0.23      22.86
9084     work  0.36  0.22      22.24
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[282]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">## Repeating the above with DT_IDF</span>
<span class="n">termFreqs</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">termFreqs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[282]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(9328,)</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[283]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">termFreqs</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Terms&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>




<div class="jp-RenderedImage jp-OutputArea-output">
<img src="javascript://"/>
</div>

</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>The above graph shows us a zift curve. This means that most of the terms are very less frequent</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[284]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TD &quot;</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">DTmatrix</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DT &quot;</span><span class="p">,</span><span class="n">DTmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>TD  (9328, 2500)
DT  (2500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[285]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">numTerms</span><span class="o">=</span><span class="n">DTmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">NDocs</span> <span class="o">=</span> <span class="n">DTmatrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">TDmatrix</span> <span class="o">=</span> <span class="n">matrix</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;numTerms &quot;</span><span class="p">,</span><span class="n">numTerms</span><span class="p">,</span><span class="s2">&quot; NDocs &quot;</span><span class="p">,</span><span class="n">NDocs</span><span class="p">)</span>

<span class="c1"># Note: doc frequency (df) for a term t is the number of docs in which t appears divided by total number of docs</span>

<span class="c1"># first let&#39;s find the doc counts for each term</span>

<span class="n">DF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">TDmatrix</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="mi">1</span><span class="p">)])</span><span class="o">.</span><span class="n">T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DF</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Create a matrix with all entries = NDocs</span>
<span class="n">NMatrix</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">TDmatrix</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">*</span><span class="n">NDocs</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">NMatrix</span><span class="p">)</span>

<span class="c1"># Convert each entry into IDF values</span>
<span class="c1"># IDF is the log of the inverse of document frequency</span>
<span class="c1"># Note that IDF is only a function of the term, so all columns will be identical.</span>

<span class="n">IDF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">NMatrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">DF</span><span class="p">)))</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">IDF</span><span class="p">)</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s2">&quot;display.precision&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Finally compute the TFxIDF values for each document-term entry</span>
<span class="n">TD_tfidf</span> <span class="o">=</span> <span class="n">TDmatrix</span> <span class="o">*</span> <span class="n">IDF</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TD_tfidf&quot;</span><span class="p">,</span><span class="n">TD_tfidf</span><span class="p">)</span>

<span class="n">DT_tfidf</span> <span class="o">=</span> <span class="n">TD_tfidf</span><span class="o">.</span><span class="n">T</span>
<span class="n">DT_tfidf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">DT_tfidf</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DT_tfidf.shape :&quot;</span><span class="p">,</span><span class="n">DT_tfidf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>numTerms  9328  NDocs  2500
(9328, 1)
[[2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 ...
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]
 [2500. 2500. 2500. ... 2500. 2500. 2500.]]
[[7.97 7.97 7.97 ... 7.97 7.97 7.97]
 [8.7  8.7  8.7  ... 8.7  8.7  8.7 ]
 [6.83 6.83 6.83 ... 6.83 6.83 6.83]
 ...
 [9.7  9.7  9.7  ... 9.7  9.7  9.7 ]
 [9.7  9.7  9.7  ... 9.7  9.7  9.7 ]
 [9.29 9.29 9.29 ... 9.29 9.29 9.29]]
TD_tfidf       0     1     2     3     4     5     6     7     8     9     ...  2490  \
0      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
1      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
2      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
3      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
4      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
...    ...   ...   ...   ...   ...   ...   ...   ...   ...   ...  ...   ...   
9323   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9324   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9325   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9326   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   
9327   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  ...   0.0   

      2491  2492  2493  2494  2495  2496  2497  2498  2499  
0      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
1      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
2      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
3      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
4      0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
...    ...   ...   ...   ...   ...   ...   ...   ...   ...  
9323   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9324   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9325   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9326   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  
9327   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0  

[9328 rows x 2500 columns]
DT_tfidf.shape : (2500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[286]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_train_df</span><span class="p">,</span> <span class="n">x_test_idf</span><span class="p">,</span> <span class="n">y_train_idf</span><span class="p">,</span> <span class="n">y_test_idf</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">DT_tfidf</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">99</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[287]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mat</span><span class="p">(</span><span class="n">x_train_df</span><span class="p">)</span>
<span class="n">centroids</span><span class="p">,</span> <span class="n">clusterAssment</span> <span class="o">=</span> <span class="n">kmeans</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; clusterAssment : &quot;</span><span class="p">,</span><span class="n">clusterAssment</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; centroids : &quot;</span><span class="p">,</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>calculating centroids : Start
calculating centroids : End 
 centroids are :: 
 [[  6.3    0.25 189.49 ...   9.79   6.25  19.73]
 [  2.2    3.46 292.34 ...   3.8    8.4   26.72]
 [  7.47   0.73  84.22 ...   2.7    5.52  24.47]
 [  6.53   4.17 240.86 ...  13.22   0.76  30.6 ]
 [  7.31   7.89 248.44 ...  12.54   1.92   0.77]]
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>/var/folders/y1/rcx3rhfx4dj1v_rvs8qnbc0c0000gn/T/ipykernel_33479/11797310.py:24: DeprecationWarning: setting an array element with a sequence. This was supported in some cases where the elements are arrays with a single element. For example `np.array([1, np.array([2])], dtype=int)`. In the future this will raise the same ValueError as `np.array([1, [2]], dtype=int)`.
  clusterAssment[i,:] = minIndex, minDIst**2
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre> clusterAssment :  (2000, 2)
 centroids :  (5, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[288]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">centroids</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[288]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([[0.  , 0.  , 0.  , ..., 1.39, 0.  , 0.  ],
       [0.02, 0.  , 1.22, ..., 0.  , 0.  , 0.  ],
       [0.09, 0.2 , 0.16, ..., 0.  , 0.  , 0.  ],
       [0.04, 0.  , 0.04, ..., 0.  , 0.  , 0.  ],
       [0.02, 0.05, 0.  , ..., 0.03, 0.03, 0.14]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[289]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">x_train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">x_train_df</span><span class="p">)</span>
<span class="n">clusterDict</span> <span class="p">,</span> <span class="n">clusterSize</span> <span class="o">=</span> <span class="n">cluster_report</span><span class="p">(</span><span class="n">x_train_df</span><span class="p">,</span><span class="n">terms</span><span class="p">,</span><span class="n">clusterAssment</span><span class="p">,</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clusterDict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">cluster# :: # of docs&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">clusterSize</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span><span class="s2">&quot; </span><span class="se">\t</span><span class="s2"> :: &quot;</span><span class="p">,</span><span class="n">clusterSize</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>0
1
2
3
4
dict_keys([0, 1, 2, 3, 4])

cluster# :: # of docs
0  	 ::  7
1  	 ::  397
2  	 ::  85
3  	 ::  762
4  	 ::  749
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[290]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">numOfTopNTerms</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">display_clusters</span><span class="p">(</span><span class="n">clusterDict</span><span class="p">,</span><span class="n">clusterSize</span><span class="p">,</span><span class="n">numOfTopNTerms</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>
Cluster  0 size = 7
----------------------------------------------
         Term      Freq    DF  % of Docs
7895  subject      0.00  1.00     100.00
547        ax  41371.61  0.86      85.71
4982      max   2826.98  0.86      85.71
9144       wt     41.19  0.71      71.43
6183       pl    296.54  0.71      71.43
8275       tm     51.71  0.71      71.43
5238       ml     30.92  0.71      71.43
5975     part      4.59  0.71      71.43
3275    ghjkn     17.41  0.71      71.43
3279       gi     15.39  0.71      71.43

Cluster  1 size = 397
----------------------------------------------
           Term  Freq    DF  % of Docs
7895    subject  0.00  1.00     100.00
9129      write  0.91  0.63      63.22
3345        god  7.66  0.56      55.92
5795         on  1.91  0.55      54.91
417      articl  0.93  0.48      47.86
1335  christian  4.96  0.46      45.59
6049      peopl  2.53  0.45      44.84
4449       know  1.52  0.43      42.82
8203      think  1.47  0.41      40.55
693      believ  2.40  0.40      39.80

Cluster  2 size = 85
----------------------------------------------
         Term  Freq    DF  % of Docs
7895  subject  0.00  1.00     100.00
5795       on  0.77  0.38      37.65
7115     sale  1.35  0.32      31.76
9129    write  0.42  0.29      29.41
8174    thank  0.75  0.27      27.06
3266      get  0.63  0.26      25.88
3339       go  0.90  0.25      24.71
8098     team  1.62  0.24      23.53
5848   origin  1.55  0.22      22.35
417    articl  0.46  0.22      22.35

Cluster  3 size = 762
----------------------------------------------
         Term  Freq    DF  % of Docs
7895  subject  0.00  1.00     100.00
9025   window  3.17  0.39      38.85
9129    write  0.46  0.30      30.31
5795       on  0.63  0.29      28.87
2550    email  0.91  0.29      28.61
8174    thank  0.78  0.28      28.48
7115     sale  1.28  0.27      26.90
6207    pleas  0.82  0.26      26.38
3266      get  0.72  0.26      25.72
4449     know  0.59  0.24      23.88

Cluster  4 size = 749
----------------------------------------------
         Term  Freq    DF  % of Docs
7895  subject  0.00  1.00     100.00
9129    write  0.84  0.60      60.35
417    articl  0.88  0.47      47.00
5795       on  1.03  0.42      41.79
3266      get  1.19  0.36      35.51
3339       go  1.28  0.32      32.04
4319     just  0.88  0.32      31.51
8203    think  0.96  0.29      29.24
4449     know  0.82  0.29      28.84
4364      kei  3.01  0.28      27.64
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 2-D<a rel="noopener" class="anchor-link" href="#Que-2-D">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Using the cluster assignments from your Kmeans clustering and the original cluster labels for the training document, compare your clusters to the re-assigned classes by computing the Completeness and Homogeneity values. You should do this for the best values of k and the best clustering run you settled on in the previous part.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[291]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">y_train_idf</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[291]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([1, 0, 0, ..., 3, 1, 0])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[292]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">clusterAssment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[292]:</div>




<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>matrix([[4., 3., 3., ..., 4., 1., 3.]])</pre>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[293]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">completeness_score</span><span class="p">,</span> <span class="n">homogeneity_score</span>

<span class="c1">#NOTE: this generates a random score every time you run the cluster</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;completeness_score = &quot;</span><span class="p">,</span><span class="n">completeness_score</span><span class="p">(</span><span class="n">y_train_idf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">clusterAssment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;homogeneity_score = &quot;</span><span class="p">,</span><span class="n">homogeneity_score</span><span class="p">(</span><span class="n">y_train_idf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">clusterAssment</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>completeness_score =  0.7038222149890767
homogeneity_score =  0.5293598469263906
</pre>
</div>
</div>

</div>

</div>

</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>Que 2-E<a rel="noopener" class="anchor-link" href="#Que-2-E">&#182;</a></h1>
</div>
</div>
<div class="jp-Cell-inputWrapper"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Finally, using your cluster assignments as class labels, categorize each of the documents in the 20% set-aside data into each of the appropriate clusters (using your final clustering results in part c). Your categorization should be based on Cosine similarity between each test document and cluster centroids. For each test document show the assigned cluster label as well as Cosine similarity to the corresponding cluster.</p>

</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[294]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">centroids</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">centroids</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;vs_test_idf shape &quot;</span><span class="p">,</span><span class="n">x_test_idf</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>(5, 9328)
[[0.   0.   0.   ... 1.39 0.   0.  ]
 [0.02 0.   1.22 ... 0.   0.   0.  ]
 [0.09 0.2  0.16 ... 0.   0.   0.  ]
 [0.04 0.   0.04 ... 0.   0.   0.  ]
 [0.02 0.05 0.   ... 0.03 0.03 0.14]]
vs_test_idf shape  (500, 9328)
</pre>
</div>
</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[295]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">x_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_test_idf</span><span class="p">)</span>
<span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">x_test</span><span class="p">:</span>
    <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">sim</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cluster</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">centroid</span> <span class="ow">in</span> <span class="n">centroids</span><span class="p">:</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">calculateCosineSimilarityDistance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="n">centroid</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">centroid_doc_sim</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">val</span> <span class="c1">#Need to subtract from 1 as our function returns distance and not similarity</span>
        <span class="c1">#print(&quot;centroid_doc_sim &quot;,centroid_doc_sim)</span>
        <span class="n">sim</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">centroid_doc_sim</span><span class="p">)</span> 
        <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Cosine Similarity to Cluster &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cluster</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">centroid_doc_sim</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cluster</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="n">dic</span><span class="p">[</span><span class="s1">&#39;Predicted Cluster&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">sim</span><span class="p">))</span> 
    
    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>

<span class="n">test_cluster</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[296]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">50</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorized test data shape &quot;</span><span class="p">,</span><span class="n">test_cluster</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">test_cluster</span>
</pre></div>

     </div>
</div>
</div>
</div>

<div class="jp-Cell-outputWrapper">


<div class="jp-OutputArea jp-Cell-outputArea">

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt"></div>


<div class="jp-RenderedText jp-OutputArea-output">
<pre>Categorized test data shape  (500, 6)
</pre>
</div>
</div>

<div class="jp-OutputArea-child">

    
    <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[296]:</div>



<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cosine Similarity to Cluster 0</th>
      <th>Cosine Similarity to Cluster 1</th>
      <th>Cosine Similarity to Cluster 2</th>
      <th>Cosine Similarity to Cluster 3</th>
      <th>Cosine Similarity to Cluster 4</th>
      <th>Predicted Cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.5583202166188386e-06</td>
      <td>0.08944121167142005</td>
      <td>0.047725441060355256</td>
      <td>0.09720361533027644</td>
      <td>0.1833544881819602</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.06185648309728442</td>
      <td>0.04123648783097833</td>
      <td>0.07969377664212973</td>
      <td>0.08677937326923102</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.501293787033788e-05</td>
      <td>0.06110296508438495</td>
      <td>0.04688141581038019</td>
      <td>0.18987198298442753</td>
      <td>0.06760655603048515</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.934667201721531e-06</td>
      <td>0.02274081886122059</td>
      <td>0.014087762938468584</td>
      <td>0.020530092916457354</td>
      <td>0.07600505882203468</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.661633320164228e-06</td>
      <td>0.3128043195712311</td>
      <td>0.05192691242888736</td>
      <td>0.0771693060384987</td>
      <td>0.07490449031494484</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>495</th>
      <td>0.0</td>
      <td>0.19135234245668953</td>
      <td>0.021125721148937182</td>
      <td>0.03392802615102131</td>
      <td>0.03710087138597007</td>
      <td>1</td>
    </tr>
    <tr>
      <th>496</th>
      <td>1.0737448201236788e-05</td>
      <td>0.03467982168154704</td>
      <td>0.052756710889425906</td>
      <td>0.033000059470316256</td>
      <td>0.1299856602891316</td>
      <td>4</td>
    </tr>
    <tr>
      <th>497</th>
      <td>6.75703351453727e-05</td>
      <td>0.036971047685655845</td>
      <td>0.03433798753139217</td>
      <td>0.042949824438580864</td>
      <td>0.07601441544082466</td>
      <td>4</td>
    </tr>
    <tr>
      <th>498</th>
      <td>1.986801586029152e-06</td>
      <td>0.031166076116140085</td>
      <td>0.03811656860629686</td>
      <td>0.19293650675300156</td>
      <td>0.04659245839460602</td>
      <td>3</td>
    </tr>
    <tr>
      <th>499</th>
      <td>3.128994675249963e-06</td>
      <td>0.036093877348874925</td>
      <td>0.04227926525790482</td>
      <td>0.05364607096406171</td>
      <td>0.12635364927742865</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>500 rows &#215; 6 columns</p>
</div>
</div>

</div>

</div>

</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
     <div class="CodeMirror cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>

     </div>
</div>
</div>
</div>

</div>









<script type="module" src="https://s.brightspace.com/lib/bsi/20.22.6-230/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.3,
							'renderLatex': false
						});
					}
				});</script></body></html>